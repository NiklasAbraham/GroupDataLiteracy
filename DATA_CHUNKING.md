test_single_chunking:

```
Selected movie ID: Q28416981
Plot length: 6253 characters

================================================================================
PLOT TEXT:
================================================================================
The story focuses on two young talented chefs, Gao Tian Ci (Nicholas Tse), a southern-style Chinese chef, and Paul Ahn (Jung Yong-hwa), a Michelin-starred Korean chef trained in France. Both have reasons to climb the culinary ladder—When Tian Ci was ten years old, his father, Gao Feng (Anthony Wong), left him behind with his friend, Uncle Seven (Ge You), master chef of Seven Restaurant. When asked why, Gao Feng told Tian Ci that he has no talent as a cook and he would only take him back if he can prove to be a great cook. In reality, Gao Feng chose to pursue his culinary career over being a father and made the excuse that Tian Ci can't even make a decent bowl of noodles. Because of that, Tian Ci spent twenty years training to become a great chef under Uncle Seven. On the other side, Paul made a promise to his dying father that he would become a great cook. Through that journey, he became a highly successful chef in Europe and decides to run his own restaurant in Hong Kong, Stellar. However, this brings conflict between Paul and Tian Ci. In an old area of Hong Kong, Tian Ci is now an acclaimed chef at Seven. However, the Li Management Group arrives and starts buying various properties of the old sector, including developing Stellar for Paul. The opening of Stellar proves to be a threat to Tian Ci as these two chefs find themselves fighting for the best ingredients in the markets and maintaining their clientele. Stellar's fine haute cuisine represents a form of aggressive gentrification to the neighborhood and a threat to traditional Chinese cuisine. Their rivalry begins with a challenge for the best fish and the culinary masters agreed to face each other in a culinary duel. Tian Ci makes a traditional salt-baked duck while Paul makes a foie gras sorbet. While both tied in points, the judges declare Paul the victor, as his dish presentation was superior to Tian Ci's bland plating. Although the victory should've solidified Paul's abilities as a cook, things do not go as expected. It was while celebrating their victory that the manager of Li Group tells Paul he wants to replace him with Mei You (Michelle Bai), sous chef and girlfriend, reasoning that a woman is far more appealing on media than a man. Betrayed and confused, Paul tries to defend his position as head chef, but Mei You exposes his dark secret: Paul has problems tasting certain flavors, especially saltiness. To compensate, he would utilize a notebook containing all his recipes and have others test taste for him. To make matters worse, the manager announces that he and Mei You are romantically involved. Mei You explains to Paul that she never loved him and only sided with him to surpass him. Now that she can take the title as executive chef of Stellar, she doesn't need Paul anymore. Angry that he has lost everything, Paul leaves. Tian Ci bumps into Paul drinking at an event stadium. Both share their past and troubles, and find mutual respect for each other. Both have a common goal of reaching the culinary top and decided to team up. At Seven, the Li Group wants Uncle Seven to sign away his restaurant, but Uncle Seven refuses. Paul and Tian Ci then appear, announcing their partnership. Paul reminds the manager that as the winner of the competition, he is eligible to compete at the culinary championship, not the Li Group. Surprised by that technicality, the Li Group leaves, hypocritically calling Paul a traitor but not before Paul headbutted the manager in revenge. Tian Ci trains Paul in the ways of Chinese cooking as well as developing Paul's limited palate to help create something new for the competition. In Macau, at the Studio City Casino, attending the 7th International Culinary Competition, Tian Ci and Paul use both their culinary strengths to compete against four other great chefs. Whoever wins the competition will gain the chance to face the current god of Cookery, Gao Feng Ko. In this competition, they face a French team, Indian team, a Japanese chef, and Mei You. The French team make a roasted squab dish, the Indian team make a five-flavor curry, the Japanese chef makes koi nigiri, Mei You, impliying that she is in the final stage thanks to manager's bribery because she hadn't enrolled to be in the competition, makes an oyster dish with frozen foam, and the duo create a deconstructed mapo tofu. Paul used Tian Ci's sense of taste to help him determine the flavor of the ingredients and Tian Ci relies on Paul's knowledge of molecular science and culinary artistry to create a traditional dish with a modern design. The victory goes to Paul and Tian Ci. In defeat, a shameful Mei You is unable to bring herself to look at Paul's in the eyes for having betrayed him and now once again having to live under Paul's shadow. Before the final round, Paul points out only one chef can compete against Gao Feng and he realizes Tian Ci's desire to beat Gao Feng was a very personal one. Grateful he managed to make it this far with his condition, Paul gives Tian Ci the chance to face his father. In the final competition, Tian Ci finally faces his father, and the judges allow the two to cook anything they want as long as it is considered the highest expression of cooking. While Gao Feng begins cooking, Tian Ci is distracted by his thoughts about how Seven and the people in the neighborhood mean the most to him. Gao Feng angrily splashes water at his son's face, demanding that he focus and show him something. Gao Feng creates a beautiful artistic sugar display of molten lava with a single flower on top. Tian Ci cooks something far more personal: an interpretation of the original noodle dish that Gao Feng made all those years ago before abandoning Tian Ci. Before the judges can score the dish, Tian Ci gives the bowl of noodles to Gao Feng, who is moved as he remembers what the noodles represent. Acknowledging his skills as a chef, Gao Feng calls his son brilliant before Tian Ci walks off the stage. Gao Feng continues to emotionally eat his noodles, with the victor unclear. Some time has passed and the people at Seven are getting ready for a poon choi Chinese New Year party with the neighborhood's people. The movie ends with the staff of Seven announcing: We wish you all 2017 a happy rooster year!
================================================================================

Token count: 1475

2025-11-15 17:14:38,973 [INFO] - Initializing EmbeddingService with model: BAAI/bge-m3
2025-11-15 17:14:38,973 [INFO] - Auto-selecting embedding strategy based on model name
2025-11-15 17:14:38,973 [INFO] - Selecting strategy for model: BAAI/bge-m3
2025-11-15 17:14:38,973 [INFO] - Selected FlagEmbeddingStrategy
2025-11-15 17:14:38,973 [INFO] - Loading FlagEmbedding model: BAAI/bge-m3
2025-11-15 17:14:39,001 [INFO] - Loading model on primary device: cuda:0
Fetching 30 files: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:00<00:00, 9541.91it/s]
2025-11-15 17:14:41,721 [INFO] - loading existing colbert_linear and sparse_linear---------
2025-11-15 17:14:41,724 [INFO] - FlagEmbedding model loaded successfully
2025-11-15 17:14:41,724 [INFO] - EmbeddingService initialized with FlagEmbeddingStrategy
2025-11-15 17:14:41,724 [INFO] - Delegating encoding to FlagEmbeddingStrategy...
2025-11-15 17:14:41,724 [INFO] - Processing 1 documents with batch size 1
2025-11-15 17:14:41,724 [INFO] - Starting FlagEmbedding encoding on 1 devices
2025-11-15 17:14:41,724 [INFO] - Processing 1 documents with batch size 1
2025-11-15 17:14:41,724 [INFO] - Start multi-process pool on devices: cuda:0, cuda:1, cuda:2
initial target device: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:15<00:00,  5.01s/it]
pre tokenize: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 146.15it/s]
You're using a XLMRobertaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
Inference Embeddings: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 38.48it/s]
Chunks: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.10it/s]
2025-11-15 17:14:58,365 [INFO] - Encoding complete. Time taken: 16.64 seconds
2025-11-15 17:14:58,365 [INFO] - Throughput: 0.06 docs/sec
2025-11-15 17:14:58,365 [INFO] - Raw output type: <class 'dict'>, keys: ['dense_vecs', 'lexical_weights', 'colbert_vecs']
2025-11-15 17:14:58,365 [INFO] - Returning result dictionary with keys: ['dense_vecs', 'lexical_weights', 'colbert_vecs']
2025-11-15 17:14:58,365 [INFO] -   dense_vecs: numpy array with shape (1, 1024), dtype float16
2025-11-15 17:14:58,366 [INFO] -   lexical_weights: <class 'list'>
2025-11-15 17:14:58,366 [INFO] -   colbert_vecs: <class 'list'>

Results dictionary structure:
Keys: ['dense_vecs', 'lexical_weights', 'colbert_vecs']
dense_vecs type: <class 'numpy.ndarray'>, shape: (1, 1024)

lexical_weights type: <class 'list'>, length: 1

Extracting noun lemmas and concepts from lexical weights...
Filtered 131 lemmas to 102 with Zipf >= 4.0
2025-11-15 17:14:59,124 [INFO] - Use pytorch device_name: cuda:0
2025-11-15 17:14:59,124 [INFO] - Load pretrained SentenceTransformer: BAAI/bge-small-en-v1.5
Loaded concept space: 18852 concepts

================================================================================
TOP 30 CONCEPTS (WORDNET 10K CONCEPT SPACE, Zipf >= 4.0):
================================================================================
 1. chef                          : 0.159699
 2. competition                   : 0.049049
 3. manager                       : 0.040440
 4. father                        : 0.038061
 5. cook                          : 0.035920
 6. victory                       : 0.032845
 7. dish                          : 0.031582
 8. judge                         : 0.029551
 9. team                          : 0.023605
10. flavor                        : 0.019188
11. neighborhood                  : 0.017827
12. victor                        : 0.017512
13. cooking                       : 0.017109
14. people                        : 0.015481
15. threat                        : 0.014922
16. year                          : 0.014125
17. master                        : 0.013373
18. taste                         : 0.013083
19. son                           : 0.011803
20. bowl                          : 0.011665
21. revenge                       : 0.010659
22. ladder                        : 0.010458
23. top                           : 0.010082
24. story                         : 0.009451
25. restaurant                    : 0.009424
26. movie                         : 0.009415
27. defeat                        : 0.009407
28. secret                        : 0.008948
29. talent                        : 0.008523
30. conflict                      : 0.008394
================================================================================

  lexical_weights[0] type: dict, keys: ['581', '13765', '32153', '90', '98', '6626', '27150', '12348', '297', '21861']... with a length of 559

================================================================================
TOP 50 MAIN WORDS FROM LEXICAL WEIGHTS:
================================================================================
  1. Token ID   2079: '▁Ci' (weight: 0.308594)
  2. Token ID 177123: '▁Feng' (weight: 0.302002)
  3. Token ID 132556: '▁Seven' (weight: 0.281982)
  4. Token ID  10208: '▁Paul' (weight: 0.277344)
  5. Token ID 150732: '▁Tian' (weight: 0.264404)
  6. Token ID  11204: '▁Mei' (weight: 0.258057)
  7. Token ID   2583: '▁You' (weight: 0.256348)
  8. Token ID    505: '▁2017' (weight: 0.255615)
  9. Token ID  21861: '▁chef' (weight: 0.255371)
 10. Token ID  13765: '▁story' (weight: 0.252197)
 11. Token ID  14277: '▁movie' (weight: 0.251221)
 12. Token ID  32153: '▁focus' (weight: 0.240356)
 13. Token ID 110309: '▁cook' (weight: 0.239624)
 14. Token ID  23410: '▁secret' (weight: 0.238770)
 15. Token ID  91375: '▁victor' (weight: 0.233643)
 16. Token ID 173618: '▁culinar' (weight: 0.229736)
 17. Token ID 179065: '▁cooking' (weight: 0.228271)
 18. Token ID  12348: '▁talent' (weight: 0.227417)
 19. Token ID  52758: '▁reven' (weight: 0.225952)
 20. Token ID 124172: '▁Stella' (weight: 0.224731)
 21. Token ID  79612: '▁conflict' (weight: 0.223999)
 22. Token ID   2902: '▁Ga' (weight: 0.223877)
 23. Token ID     15: '▁(' (weight: 0.223145)
 24. Token ID 156840: '▁Michelin' (weight: 0.220825)
 25. Token ID 130412: '▁competition' (weight: 0.218140)
 26. Token ID  31095: '▁manager' (weight: 0.215820)
 27. Token ID 208429: '▁shadow' (weight: 0.215210)
 28. Token ID   8677: '▁Ah' (weight: 0.213989)
 29. Token ID     42: 'r' (weight: 0.211670)
 30. Token ID    110: '▁no' (weight: 0.208618)
 31. Token ID   3125: 'fu' (weight: 0.206421)
 32. Token ID   3564: '▁end' (weight: 0.206177)
 33. Token ID 116983: '▁judge' (weight: 0.204346)
 34. Token ID     31: 'o' (weight: 0.203369)
 35. Token ID  67373: '▁father' (weight: 0.203125)
 36. Token ID  99552: '▁nood' (weight: 0.202393)
 37. Token ID   6602: '▁year' (weight: 0.201782)
 38. Token ID  46667: '▁woman' (weight: 0.201416)
 39. Token ID  44402: '▁problems' (weight: 0.201294)
 40. Token ID    348: '▁ang' (weight: 0.200562)
 41. Token ID  10760: '▁Group' (weight: 0.199585)
 42. Token ID  27150: '▁young' (weight: 0.199097)
 43. Token ID 120332: '▁threat' (weight: 0.199097)
 44. Token ID  70764: 'dder' (weight: 0.197876)
 45. Token ID 124166: '▁Wong' (weight: 0.197388)
 46. Token ID 167375: '▁highest' (weight: 0.196777)
 47. Token ID  76438: '▁Chinese' (weight: 0.196655)
 48. Token ID 132641: 'flower' (weight: 0.196289)
 49. Token ID  28660: '▁Restaurant' (weight: 0.195801)
 50. Token ID  60984: '▁lava' (weight: 0.192993)
================================================================================


colbert_vecs type: <class 'list'>, length: 1
  colbert_vecs[0] type: <class 'numpy.ndarray'>
    shape: (1476, 1024), dtype: float32

colbert_vecs[0] shape: (1476, 1024)
window_embeddings shape: (5, 1024)
final_embedding_pre_norm shape: (1024,)
2025-11-15 17:15:01,328 [INFO] - Delegating encoding to FlagEmbeddingStrategy...
2025-11-15 17:15:01,328 [INFO] - Processing 1 documents with batch size 1
2025-11-15 17:15:01,328 [INFO] - Starting FlagEmbedding encoding on 1 devices
2025-11-15 17:15:01,329 [INFO] - Processing 1 documents with batch size 1
pre tokenize: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 148.41it/s]
You're using a XLMRobertaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
Inference Embeddings: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 38.67it/s]
Chunks: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.07it/s]
2025-11-15 17:15:02,264 [INFO] - Encoding complete. Time taken: 0.94 seconds
2025-11-15 17:15:02,264 [INFO] - Throughput: 1.07 docs/sec
2025-11-15 17:15:02,264 [INFO] - Raw output type: <class 'dict'>, keys: ['dense_vecs', 'lexical_weights', 'colbert_vecs']
2025-11-15 17:15:02,264 [INFO] - Returning result dictionary with keys: ['dense_vecs', 'lexical_weights', 'colbert_vecs']
2025-11-15 17:15:02,264 [INFO] -   dense_vecs: numpy array with shape (1, 1024), dtype float16
2025-11-15 17:15:02,264 [INFO] -   lexical_weights: <class 'list'>
2025-11-15 17:15:02,264 [INFO] -   colbert_vecs: <class 'list'>
final_embedding shape: (1024,)
2025-11-15 17:15:03,318 [WARNING] - Error clearing CUDA cache: sys.meta_path is None, Python is likely shutting down
Exception ignored in: <function AbsEmbedder.__del__ at 0x79dbf4f38fe0>
Traceback (most recent call last):
  File "/home/nab/anaconda3/envs/dataLiteracy/lib/python3.11/site-packages/FlagEmbedding/abc/inference/AbsEmbedder.py", line 288, in __del__
  File "/home/nab/anaconda3/envs/dataLiteracy/lib/python3.11/site-packages/FlagEmbedding/abc/inference/AbsEmbedder.py", line 86, in stop_self_pool
  File "/home/nab/anaconda3/envs/dataLiteracy/lib/python3.11/site-packages/FlagEmbedding/abc/inference/AbsEmbedder.py", line 380, in stop_multi_process_pool
  File "/home/nab/anaconda3/envs/dataLiteracy/lib/python3.11/multiprocessing/process.py", line 133, in terminate
  File "/home/nab/anaconda3/envs/dataLiteracy/lib/python3.11/multiprocessing/popen_fork.py", line 57, in terminate
AttributeError: 'NoneType' object has no attribute 'SIGTERM'
/home/nab/anaconda3/envs/dataLiteracy/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 2 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
(dataLiteracy) nab@harry:~/GroupDataLiteracy$ 

```